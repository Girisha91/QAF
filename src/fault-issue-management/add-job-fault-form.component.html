<div class="faltform">
    <div class="container" style="padding: 0% !important">
        <div class="listgroup content-margin">
            <div class="row">
                <div class="col-md-12">
                    <div class="col-md-12">
                        <div class="panel-group">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <b class="page-head ftlt
                                        table-header-margin">{{title}}</b>
                                    <div *ngIf="!(opr==2)" style="float:right;"
                                        class="inline-display
                                        table-header-margin">(
                                        <span class="error"> * </span>)
                                        Mandatory</div>
                                    <button *ngIf="opr==2" type="button"
                                        (click)="closeAndRedirect()" class="btn
                                        btn-default ftrt">
                                        Back </button>

                                    <!-- <div style="float:right;" class="inline-display" >(<span class="error"> * </span>) Mandatory</div> -->
                                </div>
                                <div class="panel-body">
                                    <div class="fluid-container">
                                        <form class="form-horizontal">
                                            <!-- <div class="form-group form-group-sm"> -->
                                            <!-- left column -->
                                            <!-- <div class="form-group col-md-12"> -->
                                            <!--<div class="distinctFormHeading">
                                                     <label> {{title}}</label>
                                                    <div style="float:right;" class="inline-display">(
                                                            <span class="error"> * </span>) Mandatory</div> 
                                                </div>-->
                                            <!-- <div class="col-md-4"> -->
                                            <div class="form-row">
                                                <div class="form-group col-md-4" *ngIf="!HideUpdate">
                                                    <label>
                                                        Operation No</label>                                                
                                                        <input type="text"
                                                            [disabled]="true"
                                                            [(ngModel)]="fj.ticket_number"
                                                            value="fj.ticket_number"
                                                            name="ticket_number"
                                                            class="form-control">                                                    
                                                </div>
                                                <div class="form-group col-md-4">
                                                    <label>Operation Status
                                                        <span class="error"> *
                                                        </span></label>
                                                    <div>
                                                        <select
                                                            [disabled]="isReadOnly"
                                                            class="form-control"
                                                            [(ngModel)]="fj.ticket_status"
                                                            name="opStatus">
                                                            <option *ngFor="let
                                                                Opstatus of
                                                                OpStatusList"
                                                                [value]="Opstatus.name">{{Opstatus.name}}</option>
                                                        </select>
                                                        <div
                                                            [hidden]="errorOperationStatus
                                                            == ''"
                                                            class="error">{{errorOperationStatus}}</div>
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-4">
                                                    <label>Operation Created
                                                        Date <span
                                                            class="error"> *
                                                        </span></label>
                                                    <div>
                                                        <input type="text"
                                                            [disabled]="true"
                                                            [(ngModel)]="fj.created_date"
                                                            name="createdDate"
                                                            class="form-control"
                                                            placeholder="Created Date">
                                                        <div
                                                            [hidden]="errorOperationCreatedDate
                                                            == ''"
                                                            class="error">{{errorOperationCreatedDate}}</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-row">
                                                <div class="form-group col-md-4">
                                                    <label>Operation Assigned
                                                        Date</label>
                                                    <div>
                                                        <input
                                                            [disabled]="isReadOnly"
                                                            type="text"
                                                            bsDatepicker
                                                            [(ngModel)]="fj.assigned_date"
                                                            name="assignDate"
                                                            class="form-control"
                                                            placeholder="Assign Date"
                                                            [bsConfig]="{
                                                            dateInputFormat:
                                                            'YYYY-MM-DD' }">
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-4">
                                                    <label>Site Name <span
                                                            class="error"> *
                                                        </span></label>
                                                    <div>
                                                        <select
                                                            [disabled]="isReadOnly"
                                                            class="form-control"
                                                            [(ngModel)]="fj.site_name_id"
                                                            name="siteName">
                                                            <option *ngFor="let
                                                                sn of siteList"
                                                                [value]="sn.id">
                                                                {{sn.name}}</option>
                                                        </select>
                                                        <div
                                                            [hidden]="errorSiteName
                                                            == ''"
                                                            class="error">{{errorSiteName}}</div>
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-4">
                                                    <label>Department <span
                                                            class="error"> *
                                                        </span></label>
                                                    <div>
                                                        <select
                                                            [disabled]="isReadOnly"
                                                            class="form-control"
                                                            [(ngModel)]="fj.department_id"
                                                            name="Department">
                                                            <option *ngFor="let
                                                                dept of
                                                                DepartmentList"
                                                                [value]="dept.id">{{dept.label}}</option>
                                                        </select>
                                                        <div
                                                            [hidden]="errorDepartment
                                                            == ''"
                                                            class="error">{{errorDepartment}}</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-row">
                                                <div class="form-group col-md-4">
                                                    <label>Severity</label>
                                                    <div>
                                                        <select
                                                            [disabled]="isReadOnly"
                                                            class="form-control"
                                                            [(ngModel)]="fj.severity_id"
                                                            name="severity">
                                                            <option *ngFor="let
                                                                svt of
                                                                SeverityList"
                                                                [value]="svt.id">{{svt.name}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <!-- </div> -->
                                                <!-- <div class="col-md-4"> -->
                                                <div class="form-group col-md-4">
                                                    <label>Operation Type <span
                                                            class="error"> *
                                                        </span></label>
                                                    <div>
                                                        <select
                                                            [disabled]="isReadOnly"
                                                            class="form-control"
                                                            [(ngModel)]="fj.operation_type"
                                                            name="opType">
                                                            <option *ngFor="let
                                                                opt of
                                                                OpTypeList"
                                                                [value]="opt.name">{{opt.name}}</option>
                                                        </select>
                                                        <div
                                                            [hidden]="errorOperationType
                                                            == ''"
                                                            class="error">{{errorOperationType}}</div>
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-4">
                                                    <label>Operation Sub Type</label>
                                                    <div>
                                                        <select
                                                            [disabled]="isReadOnly"
                                                            class="form-control"
                                                            [(ngModel)]="fj.operation_sub_type_id"
                                                            name="opSubType">
                                                            <option *ngFor="let
                                                                opst of
                                                                OpSubTypeList"
                                                                [value]="opst.id">{{opst.name}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-row">
                                                <div class="form-group col-md-4">
                                                    <label>Reported
                                                        By</label>
                                                    <div>
                                                        <select
                                                            [disabled]="isReadOnly"
                                                            class="form-control"
                                                            [(ngModel)]="fj.reported_by_id"
                                                            name="reportedBy">
                                                            <option *ngFor="let
                                                                rb of
                                                                OpReportedByList"
                                                                [value]="rb.id">{{rb.name}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-4">
                                                    <label>Reported
                                                        To</label>
                                                    <!-- <div >
                                                            <select  [disabled]="isReadOnly" class="form-control" [(ngModel)]="fj.reported_to_id"
                                                                name="reportedTo">
                                                                
                                                                <option *ngFor="let rt of OpReportedToList"
                                                                    [value]="rt.id">{{rt.name}}</option>
                                                            </select>
                                                            <div class="form-control">
                                                                <ul  *ngFor="let rt of OpReportedToList">
                                                                    <li [value]="rt.id"> {{rt.name}} <input type="checkbox"></li>
                                                                </ul>
                                                            </div>

                                                        </div> -->
                                                        <!-- multiple select check box -->
                                                    <div>
                                                        <input type="text"
                                                            [disabled]="isReadOnly"
                                                            class="form-control whitebc"
                                                            style="width:
                                                            -webkit-fill-available;"
                                                            readonly
                                                            (click)="showList=
                                                            !showList"
                                                            [value]="itemName"
                                                            />

                                                        <ul class="list
                                                        form-control"
                                                            style="background-color:
                                                            white; float: right;
                                                            padding: 0;
                                                            width:85%; position:
                                                            absolute;border-style:
                                                            groove;
                                                            z-index: 1000;
                                                            height: 80px;
                                                            overflow-y: auto;"
                                                            *ngIf="showList">
                                                            <ul style="padding-left:
                                                                5%;"
                                                                *ngFor="let rt
                                                                of
                                                                OpReportedToList;
                                                                let i= index;"
                                                                (click)="checkUser(i)">
                                                                <ng-container
                                                                    *ngIf="rt.selected
                                                                    then
                                                                    selected
                                                                    else
                                                                    notSelected">
                                                                </ng-container>
                                                                <ng-template
                                                                    #selected>
                                                                    <input
                                                                        type="checkbox"
                                                                        value="rt.id"
                                                                        checked
                                                                        />
                                                                    {{rt.name}}
                                                                </ng-template>
                                                                <ng-template
                                                                    #notSelected>
                                                                    <input
                                                                        type="checkbox"
                                                                        value="rt.id"
                                                                        />
                                                                    {{rt.name}}
                                                                </ng-template>
                                                            </ul>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="form-group col-md-4">
                                                    <label>
                                                        Requested By</label>
                                                    <div>
                                                        <input
                                                            [disabled]="isReadOnly"
                                                            type="text"
                                                            [(ngModel)]="fj.requested_by"
                                                            name="requested_by"
                                                            class="form-control"
                                                            placeholder="Requested By">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-row">
                                                <div class="form-group col-md-4">
                                                    <label>Brief
                                                        Description of Action
                                                        <span class="error"> *
                                                        </span></label>
                                                    <div>
                                                        <input
                                                            [disabled]="isReadOnly"
                                                            type="text"
                                                            [(ngModel)]="fj.description"
                                                            name="bDescrition"
                                                            class="form-control"
                                                            placeholder="Brief Description of Action">
                                                        <div
                                                            [hidden]="errorBreafDescription
                                                            == ''"
                                                            class="error">{{errorBreafDescription}}</div>
                                                    </div>
                                                </div>
                                                <div *ngIf="HideUpdate"
                                                    class="form-group col-md-4">
                                                    <label>Action
                                                        Needed From</label>
                                                    <div>
                                                        <input type="text"
                                                            [(ngModel)]="fj.action_needed_from"
                                                            name="actionNeededFrom"
                                                            class="form-control"
                                                            placeholder="Action Needed From">

                                                    </div>
                                                </div>
                                                <!-- </div> -->
                                                <!-- <div *ngIf="HideUpdate" class="col-md-4"> -->
                                                <div *ngIf="HideUpdate"
                                                    class="form-group col-md-4">
                                                    <label>Action
                                                        Taken By</label>
                                                    <div>
                                                        <input type="text"
                                                            [(ngModel)]="fj.action_taken_by"
                                                            class="form-control"
                                                            name="actionTakenBy"
                                                            placeholder="Action Taken By">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-row">
                                                <div *ngIf="HideUpdate"
                                                    class="form-group col-md-4">
                                                    <label>Brief
                                                        Description of
                                                        Resolution</label>
                                                    <div>
                                                        <input type="text"
                                                            [(ngModel)]="fj.description_action"
                                                            name="bdreso"
                                                            class="form-control"
                                                            placeholder="Brief Description of Resolution">

                                                    </div>
                                                </div>
                                                <div *ngIf="HideUpdate"
                                                    class="form-group col-md-4">
                                                    <label>Operation Recorded
                                                        Date</label>
                                                    <div>
                                                        <input type="text"
                                                            bsDatepicker
                                                            [(ngModel)]="fj.recorded_date"
                                                            name="recordedDate"
                                                            class="form-control"
                                                            placeholder="Recorded Date"
                                                            [bsConfig]="{ dateInputFormat: 'YYYY-MM-DD' }">
                                                    </div>
                                                </div>
                                                <div *ngIf="HideUpdate"
                                                    class="form-group col-md-4">
                                                    <label>Current
                                                        Status <span
                                                            class="error"> *
                                                        </span></label>
                                                    <div>
                                                        <select
                                                            class="form-control"
                                                            [(ngModel)]="fj.current_status_id"
                                                            name="currentStatus">
                                                            <option *ngFor="let
                                                                opsctatus of
                                                                currentStatus"
                                                                [value]="opsctatus.id">{{opsctatus.name}}</option>
                                                        </select>
                                                        <div
                                                            [hidden]="errorCurrentStatus
                                                            == ''"
                                                            class="error">{{errorCurrentStatus}}</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-row">
                                                <div *ngIf="HideUpdate"
                                                    class="form-group col-md-4">
                                                    <label>External Ticket No</label>
                                                    <div>
                                                        <input type="text"
                                                            [(ngModel)]="fj.external_ticket_no"
                                                            name="Eticket"
                                                            class="form-control"
                                                            placeholder="External Ticket No">

                                                    </div>
                                                </div>
                                                <div *ngIf="HideUpdate"
                                                    class="form-group col-md-4">
                                                    <label>Recorded
                                                        By</label>
                                                    <div>
                                                        <input type="text"
                                                            [disabled]="true"
                                                            [(ngModel)]="fj.recorded_by_id"
                                                            name="recordedBy"
                                                            class="form-control"
                                                            placeholder="Recorded By">
                                                    </div>
                                                </div>
                                                <div *ngIf="HideUpdate"
                                                    class="form-group col-md-4">
                                                    <label>Remarks</label>
                                                    <div>
                                                        <input type="text"
                                                            [(ngModel)]="fj.remarks"
                                                            name="remarks"
                                                            class="form-control"
                                                            placeholder="Remarks">
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- </div> -->
                                            <!-- </div> -->
                                            <!-- </div> -->
                                        </form>
                                    </div>
                                    <div class="col-md-12 center-align">
                                            <button type="button" *ngIf="opr == '0'"
                                                (click)="addFaultJob(fj)" class="btn btn-default
                                                primary">
                                                {{title}}</button>
                                            <button type="button" *ngIf="opr == '1'"
                                                (click)="updateTicketData(fj)" class="btn btn-default
                                                primary">
                                                {{title}}</button>
                                            <button *ngIf="!(opr==2)" type="button" (click)="closeAndRedirect()"
                                                class="btn btn-default">
                                                Cancel </button>
                                            <br />
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <table *ngIf="hideHistory" class="table table-striped
                    table-bordered">
                    <thead>
                        <tr>
                            <th class="text-center">History No </th>
                            <th class="text-center">Action Needed From </th>
                            <th class="text-center">ActionTaken By</th>
                            <th class="text-center">BriefcDescription of
                                Resolution</th>
                            <th class="text-center">Operation Recorded Date</th>
                            <th class="text-center">CurrentStatus</th>
                            <th class="text-center">External Ticket No</th>
                            <th class="text-center">Recorded By</th>
                            <th class="text-center">Remarks</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let history of historyData">
                            <!-- <td>
                                <ng-select  class="selectMaterialDD" [disabled]="itemIsReadOnly" [items]="this.materialList" bindLabel="Material Name" [(ngModel)]="field.label" (change)="changeItemList(field,i)">
                                    </ng-select>
                           
                        </td> -->
                            <td>
                                <input [(ngModel)]="history.history_number"
                                    [disabled]="true" class="form-control"
                                    type="text"
                                    />
                            </td>
                            <td>
                                <input [(ngModel)]="history.action_needed_from"
                                    [disabled]="true" class="form-control"
                                    type="text"
                                    />
                            </td>
                            <td>
                                <input [(ngModel)]="history.action_taken_by"
                                    [disabled]="true" class="form-control"
                                    type="text"
                                    />
                            </td>
                            <td>
                                <input [(ngModel)]="history.description_action"
                                    [disabled]="true" class="form-control"
                                    type="text"
                                    />
                            </td>
                            <td>
                                <input [(ngModel)]="history.recorded_date"
                                    [disabled]="true" class="form-control"
                                    type="text"
                                    />
                            </td>

                            <td>
                                <input [(ngModel)]="history.current_status"
                                    [disabled]="true" class="form-control"
                                    type="text"
                                    />
                            </td>
                            <td>
                                <input [(ngModel)]="history.external_ticket_no"
                                    [disabled]="true" class="form-control"
                                    type="text"
                                    />
                            </td>
                            <td>
                                <input [(ngModel)]="history.recorded_by"
                                    [disabled]="true" class="form-control"
                                    type="text"
                                    />
                            </td>

                            <td>
                                <input [(ngModel)]="history.remarks"
                                    [disabled]="true" class="form-control"
                                    type="text"
                                    />
                            </td>

                        </tr>

                    </tbody>
                </table>
               
            </div>
        </div>
    </div>
</div>